{% extends 'MunicipalesBundle:theme:layout.html.twig' %}

{% block title %}{{ 'candidacy.step2.html_title'|trans }}{% endblock %}

{% form_theme form 'MunicipalesBundle:theme:forms.html.twig' %}

{% form_theme form 'MunicipalesBundle:theme:forms.html.twig' %}

{% from 'MunicipalesBundle:macros:steps.html.twig' import steps_widget %}

{% block appjsinline %}
	
	<link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet">
	<link href="{{ asset('bundles/municipales/bootstrap-fileinput/css/fileinput.min.css') }}" media="all" rel="stylesheet" type="text/css" />
	<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
	<script src="{{ asset('bundles/municipales/bootstrap-fileinput/js/fileinput.min.js') }}"></script>
    <script>
			$(document).ready(function()
			{
				var upload_processor = function(fileidentifier)
				{
					var allowed_mimes = {
					    pdf: function(vType, vName) {
					        return (typeof vType !== "undefined") ? vType == 'application/pdf' : vName.match(/\.(pdf)$/i);
					    },
					}
	
					$(fileidentifier).fileinput('refresh', {browseLabel: 'Examinar', removeLabel: 'Borrar'});
	
					$(fileidentifier).fileinput({
						showUpload: true, 
						maxFileCount: 1, 
						mainClass: "input-group-lg", 
						previewFileIcon: '<i class="glyphicon glyphicon-file"></i>',
						browseLabel: 'Examinar', 
						browseIcon: '<i class="glyphicon glyphicon-folder-open"></i> &nbsp;',
						browseClass : 'browse-class',
						removeLabel: 'Borrar',
						removeTitle: 'Eliminar archivos seleccionados',
						removeClass: 'btn btn-xs btn-default',
						cancelLabel: 'Cancelar',
						uploadLabel: 'Subir',
						uploadTitle: 'Subir archivos seleccionados',
						uploadClass: 'btn btn-xs btn-default',
						elCaptionText: 'elCaptionText',
						maxFileSize: 1024,
						msgSizeTooLarge: 'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>. Please retry your upload!',
						fileTypeSettings: allowed_mimes
					});
					
					$(fileidentifier).on('fileclear', function(event) 
					{
					    console.log("fileclear");
					});
	
					$(fileidentifier).on('fileerror', function(event, file, previewId, index) 
					{
					    console.log("fileerror");
					});
	
					$(fileidentifier).on('fileloaded', function(event, file, previewId, index, reader) 
					{
					    console.log("fileloaded");
					    /*console.log(event)
					    console.log(file)
					    console.log(previewId)
					    console.log(index)
					    console.log(reader)
					    */
					    $('#' + event.target.id).parent().parent().parent().children().eq(0).find('div.status_label').text('');
					});
	
					$(fileidentifier).on('filereset', function(event) 
					{
					    console.log("filereset");
					});
	
					$(fileidentifier).on('fileimageloaded', function(event, previewId) 
					{
					    console.log("fileimageloaded");
					});
	
					$(fileidentifier).on('filebrowse', function(event) 
					{
					    console.log("File browse triggered.");
					});
	
					$(fileidentifier).on('filebatchselected', function(event, files) 
					{
					    console.log('File batch selected triggered');
					});
	
					$(fileidentifier).on('fileselectnone', function(event) {
					    console.log("Huh! No files were selected.");
					});
	
					$(fileidentifier).on('filelock', function(event, filestack, extraData) {
					    var fstack = filestack.filter(function(n){ return n != undefined });
					    console.log('Files selected - ' + fstack.length);
					});
	
					$(fileidentifier).on('fileunlock', function(event, filestack, extraData) {
					    var fstack = filestack.filter(function(n){ return n != undefined });
					    console.log('Files selected - ' + fstack.length);
					});
	
					$(fileidentifier).on('filepredelete', function(event, key, jqXHR) {
					    console.log('Key = ' + key);
					});
	
					$(fileidentifier).on('filedeleted', function(event, key) {
					    console.log('Key = ' + key);
					});
	
					$(fileidentifier).on('filedeleteerror', function(event, data, preview, index) {
					    console.log('File delete error');
					});
	
					$(fileidentifier).on('filepreupload', function(event, data, previewId, index, jqXHR) {
					    var form = data.form, files = data.files, extra = data.extra, 
					        response = data.response, reader = data.reader;
					    console.log('File pre upload triggered');
					});
	
					$(fileidentifier).on('fileuploaded', function(event, data, previewId, index) {
					    var form = data.form, files = data.files, extra = data.extra, 
					        response = data.response, reader = data.reader;
					    console.log('File uploaded triggered');
					});
	
					$(fileidentifier).on('fileuploaderror', function(event, data, previewId, index) {
					    var form = data.form, files = data.files, extra = data.extra, 
					        response = data.response, reader = data.reader;
					    console.log('File upload error');
					});
	
					$(fileidentifier).on('filebatchpreupload', function(event, data, jqXHR) {
					    var form = data.form, files = data.files, extra = data.extra, 
					        response = data.response, reader = data.reader;
					    console.log('File batch pre upload triggered');
					});
	
					$(fileidentifier).on('filebatchuploadsuccess', function(event, data) {
					    var form = data.form, files = data.files, extra = data.extra, 
					        response = data.response, reader = data.reader;
					    console.log('File batch upload success');
					});
	

				};

				upload_processor('#candidacy_step2_program');
				upload_processor('#candidacy_step2_legal_conditions');
				upload_processor('#candidacy_step2_recall_term');
				upload_processor('#candidacy_step2_participatory_term');
				upload_processor('#candidacy_step2_voter_conditions');
				upload_processor('#candidacy_step2_technical_constrains');
				
				// div.form-control.file-caption.kv-fileinput-caption
				$('.kv-fileinput-caption').each(function(index, value)
				{
					$(this).prepend('<div style="display:inline-block;float:left;"><i class=" mine-icon fa fa-upload"></i></div><div class="status_label" style="margin-left: 23px;margin-top: -19px;position: relative;float:left;display:inline-block;width:500px;height:30px">Subir archivo...</div>');
				}); //.delay( 1500 );

			});
	</script>
{% endblock %}


{% block content %}

    <section class="section-2">
      <div class="container marketing">
      
        <div class="headline">
          <h2>{{ 'home.step_h2'|trans }} 2</h2>
        </div><h3 class="featurette-headin"> <i>{{ 'home.step_2'|trans }}</i>
        </h3>

        <!-- START THE FEATURETTES -->

        <hr class="featurette-divider2">
        
        {{ form_start(form, { 'attr': {'class': 'form_settings'}}) }}
        
        <!--    division -->
        <div class="row featurette2">
          <div class="widget-box">
            
            	

            <div class="widget-body">
              <div class="widget-main">
                <div id="fuelux-wizard-container">
                  {{ steps_widget(2) }}
                  
                  <hr>

                  
                  
                  
                  <div class="step-content pos-rel container-fluid">

                  	  {% if not form.vars.valid and form.vars.errors|length > 0 %}
	                  <div class="alert alert-danger">
	                          <button data-dismiss="alert" class="close" type="button">
	                            <i class="mine-icon fa fa-times"></i>
	                          </button>
	                          {{ form_errors(form) }}
	                  </div>
	                  {% endif %}
                  
		              <div class="row">
		                <h2 class="col-md-8 col-sm-offset-2 text-center">{{ 'candidacy.step2.h1_title'|trans|raw }}</h2>
		              </div>
		              
		              <div class="row">
		                <div class="col-md-offset-2 col-md-8 well">
		
		                  <p class="lead2 text-center">
		                    {{ 'candidacy.step2.p1'|trans|raw }}
		                  </p>
		                </div>
		              </div>
		              
		              <hr class="featurette-divider2">
		              
		              <div class="step-pane active col-xs-12" data-step="1">
		
		                <div class="col-md-offset-2 col-md-9 form-horizont">
		                  <div class="row">
		                  
		                    <div class="form-group row{% if form.program.vars.errors|length > 0 %} has-error{% endif %}">
		                      <div class="col-xs-12">
		                        <label class="required control-label" for="candidacy_step2_program">
		                          {{ form_label(form.program, 'candidacy.step2.program'|trans) }}
		                        </label>
		                      </div>
		                      <div class="input-group col-xs-12">
		                        <div class="col-xs-8 col-md-10">
		                          <label class="mine-file-input">
		                            {{ form_widget(form.program, {'attr' : {'class' : 'file' , 'multiple' : 'false'}}) }}
		                            {#
		                            <span data-title="Examinar" class="mine-file-container">
		                            	
		                              <span data-title="Subir archivo..." class="mine-file-name"> <i class=" mine-icon fa fa-upload"></i>
		                              </span>
		                            </span>
		                            <a href="#" class="remove">
		                              <i class=" mine-icon fa fa-times"></i>
		                            </a>
		                            #}
		                            {{ form_errors(form.program) }}
		                          </label>
		                        </div>
		                        {# 
		                        <div class="col-xs-4 col-md-2 row">
		                          <a class="col-xs-12 row" title="{{ 'candidacy.step2.program'|trans }}" href="{{ asset('bundles/municipales/pdf/program_example.pdf') }}">{{ 'candidacy.step2.example'|trans }}</a>
		                        </div>
		                        #}
		                      </div>
		
		                    </div>
		                    
		                    <div class="form-group row{% if form.legal_conditions.vars.errors|length > 0 %} has-error{% endif %}">
		                      <div class="col-xs-12">
		                        <label class="required control-label" for="candidacy_step2_legal_conditions">
		                          {{ form_label(form.legal_conditions, 'candidacy.step2.legal_conditions'|trans) }}
		                        </label>
		                      </div>
		                      <div class="input-group col-xs-12">
		                        <div class="col-xs-8 col-md-10">
		                          <label class="mine-file-input">
		                            {{ form_widget(form.legal_conditions, {'attr' : {'class' : 'file' , 'multiple' : 'false'}}) }}
		                            {{ form_errors(form.legal_conditions) }}
		                          </label>
		                        </div>
		                        
		                        {# 
		                        <div class="col-xs-4 col-md-2 row">
		                          <a class="col-xs-12 row" title="{{ 'candidacy.step2.legal_conditions'|trans }}" href="{{ asset('bundles/municipales/pdf/legal_conditions_example.pdf') }}">{{ 'candidacy.step2.example'|trans }}</a>
		                        </div>
		                        #}
		                      </div>
		                    </div>
		
	
	
		                    <div class="form-group row{% if form.recall_term.vars.errors|length > 0 %} has-error{% endif %}">
		                      <div class="col-xs-12">
		                        <label class="required control-label" for="candidacy_step2_participatory_term">
		                          {{ form_label(form.recall_term, 'candidacy.step2.recall_term'|trans) }}
		                        </label>
		                      </div>
		                      <div class="input-group col-xs-12">
		                        <div class="col-xs-8 col-md-10">
		                          <label class="mine-file-input">
		                              {{ form_widget(form.recall_term, {'attr' : {'class' : 'file' , 'multiple' : 'false'}}) }}
		                              {{ form_errors(form.recall_term) }}
		                          </label>
		                        </div>
		                        
		                        {# 
		                        <div class="col-xs-4 col-md-2 row">
		                          <a href="{{ asset('bundles/municipales/pdf/recall_term_example.pdf') }}" title="{{ 'candidacy.step2.recall_term'|trans }}" class="col-xs-12 row">{{ 'candidacy.step2.example'|trans }}</a>
		                        </div>
		                        #}
		                      </div>
		
		                    </div>
		                    
		                      
		                    
		                    <div class="form-group row{% if form.participatory_term.vars.errors|length > 0 %} has-error{% endif %}">
		                      <div class="col-xs-12">
		                        <label for="candidacy_step2_recall_term" class="required control-label">
		                          {{ form_label(form.participatory_term, 'candidacy.step2.participatory_term'|trans) }}
		                        </label>
		                      </div>
		                      <div class="input-group col-xs-12">
		                        <div class="col-xs-8 col-md-10">
		                          <label class="mine-file-input">
		                              {{ form_widget(form.participatory_term, {'attr' : {'class' : 'file' , 'multiple' : 'false'}}) }}
		                              {{ form_errors(form.participatory_term) }}
		                          </label>
		                        </div>
		                        
		                        {#
		                        <div class="col-xs-4 col-md-2 row">
		                          <a class="col-xs-12 row" title="{{ 'candidacy.step2.participatory_term'|trans }}" href="{{ asset('bundles/municipales/pdf/participatory_term_example.pdf') }}">{{ 'candidacy.step2.example'|trans }}</a>
		                        </div>
		                        #}
		                      </div>
		
		                    </div>
		                    

		                    
		                    <div class="form-group row{% if form.voter_conditions.vars.errors|length > 0 %} has-error{% endif %}">
		                      <div class="col-xs-12">
		                        <label for="candidacy_step2_voter_conditions" class="required control-label">
		                          {{ form_label(form.voter_conditions, 'candidacy.step2.voter_conditions'|trans) }}
		                        </label>
		                      </div>
		                      <div class="input-group col-xs-12">
		                        <div class="col-xs-8 col-md-10">
		                          <label class="mine-file-input">
		                              {{ form_widget(form.voter_conditions, {'attr' : {'class' : 'file' , 'multiple' : 'false'}}) }}
		                              {{ form_errors(form.voter_conditions) }}
		                          </label>
		                        </div>
		                        
		                        {#
		                        <div class="col-xs-4 col-md-2 row">
		                          <a href="{{ asset('bundles/municipales/pdf/voter_conditions_example.pdf') }}" title="{{ 'candidacy.step2.voter_conditions'|trans }}" class="col-xs-12 row">{{ 'candidacy.step2.example'|trans }}</a>
		                        </div>
		                        #}
		                      </div>
		
		                    </div>
		                    
		                    

		                    <div class="form-group row{% if form.technical_constrains.vars.errors|length > 0 %} has-error{% endif %}">
		                      <div class="col-xs-12">
		                        <label class="required control-label" for="candidacy_step2_technical_constrains">
		                          {{ form_label(form.technical_constrains, 'candidacy.step2.technical_constrains'|trans) }}
		                        </label>
		                      </div>
		                      <div class="input-group col-xs-12">
		                        <div class="col-xs-8 col-md-10">
		                          <label class="mine-file-input">
		                              {{ form_widget(form.technical_constrains, {'attr' : {'class' : 'file' , 'multiple' : 'false'}}) }}
		                              {{ form_errors(form.technical_constrains) }}
		                          </label>
		                        </div>
		                        
		                        {#
		                        <div class="col-xs-4 col-md-2 row">
		                          <a class="col-xs-12 row" title="{{ 'candidacy.step2.technical_constrains'|trans }}" href="{{ asset('bundles/municipales/pdf/technical_constrains_example.pdf') }}">{{ 'candidacy.step2.example'|trans }}</a>
		                        </div>
		                        #}
		                      </div>
		                    </div>
		                  </div>
		                </div>
		              </div>
		            </div>
                  
   
                  </div>
                </div>
                
				<hr>
				
                <div class="wizard-actions">
                  <button class="btn btn-prev" onclick="location.href='{{ path('municipales_candidacy_step_verify') }}'; return false;">
                    <i class="mine-icon fa fa-arrow-left"></i>
                    {{ 'candidacy.step2.previous'|trans }}
                  </button>
                  
					{{ form_widget(form.continue, { 'label': 'candidacy.step2.continue'|trans|raw, 'attr' : { 'class' : 'submit btn btn-success btn-next'} }) }}
                  
                </div>

              </div>
              <!-- /.widget-main --> </div>
            <!-- /.widget-body --> </div>
        </div>

        {{ form_rest(form) }}
			
	{{ form_end(form) }}
	
        <!--    division -->

        <!-- /END THE FEATURETTES --> </div>

</section>
{% endblock %}